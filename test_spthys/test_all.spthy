/* 
 * Comprehensive test file for Tamarin syntax highlighting
 */

theory TestSyntaxHighlighting
begin

builtins: diffie-hellman, hashing, symmetric-encryption

// Test macro definitions
macro MAC(k, m) = mac(m, k)
macro KDF(k, n) = kdf(k, n)
macro PK($A) = pk($A)

// Test preprocessor directives
#ifdef PREPROCESSING
/* Preprocessor directives are properly highlighted now */
#endif

// Test keywords
rule KeyGen:
  [ Fr(~k) ] 
  -->
  [ !Key($A, ~k) ]

// Test begin/end keywords
rule Begin_End_Test:
  let
    pubkey = PK($A)
    tag = MAC(~k, $A)
    t' = MAC(k, m)  // Test apostrophe variable
  in
  [ Fr(~k) ]
  --[ Begin('auth', $A) ]->
  [ Out(<$A, pubkey, tag>) ]

// Test special constant 'g'
rule DHTest:
  [ Fr(~a) ]
  -->
  [ Out(g^~a) ]

// Test tactic keywords
lemma auth_test:
  "All A B #i. Auth(A, B) @ #i ==> Ex #j. Send(A, B) @ #j & j < i"
  tactic direct

// Test comments with proper gray color and no red squiggles
/* 
 * This is a multi-line comment
 * It should be properly colored as gray
 * With no red squiggly underlines for spelling
 */

end
